<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lenovo Intel i915 Video Drivers in Linux - Everyday Linux</title>
<meta name="author" content="Everyday Linux">
<meta name="description" content="Examples of working solutions in everyday Linux.">

<meta name="generator" content="Hugo 0.80.0" />


<link href="//fonts.googleapis.com/css?family=Roboto:300" rel="stylesheet">
<link rel="stylesheet" href='/assets/css/main.6c6783c882af.css'>


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/img/apple-touch-icon.png">
<link rel="shortcut icon" href="/assets/img/favicon.ico">


<link href="/posts/index.xml" rel="alternate" type="application/rss+xml" title="Everyday Linux" />
<link href="/posts/index.xml" rel="feed" type="application/rss+xml" title="Everyday Linux" />

<meta property="og:title" content="Lenovo Intel i915 Video Drivers in Linux" />
<meta property="og:description" content="Note: Out of Date and incorrect analysis.
 I’m running fedora 27 on my Lenovo T460s and have been for a while. I have a docking station with two 24&#34; monitors at work and another docking station with two 27&#34; monitors at home. I switch between them frequently. Back in fedora 21 and 22 I had tons of problems. Sometimes monitors didn’t come on, sometimes one monitor came on, and sometimes things worked fine." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://briantward.github.io/lenovo-linux-intel-i915-video/" />
<meta property="article:published_time" content="2018-05-19T00:00:00+00:00" />
<meta property="article:modified_time" content="2018-05-19T00:00:00+00:00" />


<meta itemprop="name" content="Lenovo Intel i915 Video Drivers in Linux">
<meta itemprop="description" content="Note: Out of Date and incorrect analysis.
 I’m running fedora 27 on my Lenovo T460s and have been for a while. I have a docking station with two 24&#34; monitors at work and another docking station with two 27&#34; monitors at home. I switch between them frequently. Back in fedora 21 and 22 I had tons of problems. Sometimes monitors didn’t come on, sometimes one monitor came on, and sometimes things worked fine.">
<meta itemprop="datePublished" content="2018-05-19T00:00:00+00:00" />
<meta itemprop="dateModified" content="2018-05-19T00:00:00+00:00" />
<meta itemprop="wordCount" content="419">



<meta itemprop="keywords" content="linux,intel,i915,video,T460s,Lenovo," />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Lenovo Intel i915 Video Drivers in Linux"/>
<meta name="twitter:description" content="Note: Out of Date and incorrect analysis.
 I’m running fedora 27 on my Lenovo T460s and have been for a while. I have a docking station with two 24&#34; monitors at work and another docking station with two 27&#34; monitors at home. I switch between them frequently. Back in fedora 21 and 22 I had tons of problems. Sometimes monitors didn’t come on, sometimes one monitor came on, and sometimes things worked fine."/>


  </head>
  <body>
    <nav>
  <div class="title">
    
      <a href="/" title="Homepage">
        Everyday Linux
      </a>
    
  </div>
  <div class="nav">
    
      <a href="/" title="Homepage">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
          <polyline points="9 22 9 12 15 12 15 22" />
        </svg>
      </a>
    
    <a href="/posts/index.xml" title="RSS">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="rss"
      >
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
  </div>
</nav>

    <main>
      
  <article>
    <header>
      <p>
        <time datetime="2018-05-19 12:00">2018-05-19</time> &bull;
          
            
            <a href="/categories/linux">LINUX</a>
          </p>
      <h1>Lenovo Intel i915 Video Drivers in Linux</h1>
      <p>
        
          
            
            <a href="/tags/linux">
              <span class="hash">#</span>linux</a>
          
            , 
            <a href="/tags/intel">
              <span class="hash">#</span>intel</a>
          
            , 
            <a href="/tags/i915">
              <span class="hash">#</span>i915</a>
          
            , 
            <a href="/tags/video">
              <span class="hash">#</span>video</a>
          
            , 
            <a href="/tags/t460s">
              <span class="hash">#</span>T460s</a>
          
            , 
            <a href="/tags/lenovo">
              <span class="hash">#</span>Lenovo</a>
          
        
      </p>
    </header>
    <section>
      
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Note: Out of Date and incorrect analysis.</p>
</div>
<div class="paragraph">
<p>I’m running fedora 27 on my Lenovo T460s and have been for a while.  I have
a docking station with two 24&#34; monitors at work and another docking station with two 27&#34; monitors at home.  I switch between them frequently.  Back in fedora
21 and 22 I had tons of problems.  Sometimes monitors didn’t come on,
sometimes one monitor came on, and sometimes things worked fine.  It got better
as of fedora 27, such that I was pretty happy with things.  I’m thankful for the
hard work put into the video drivers by the people behind fedora, the linux kernel, and the many other distributions contributing.</p>
</div>
<div class="paragraph">
<p>Something happened recently where things went a little backward.  All of a
sudden, I was having complete crashes and uncontrolled reboots when moving
my laptop from one docking station to another.  Maybe it had to do with
moving between docking stations.  Maybe it just had to do with docking
stations in general.  I don’t know
the details exactly, but here is my own system analysis.</p>
</div>
<div class="paragraph">
<p>This error had been showing up a lot in my system journal/dmesg, right
at the time of crash:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>kernel: [drm:intel_ddi_prepare_link_retrain [i915]] *ERROR* Timeout waiting for DDI BUF C idle bit</pre>
</div>
</div>
<div class="paragraph">
<p>It apparently started in April with kernel 4.15.9-300.fc27.x86_64:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>kernel: Linux version 4.15.9-300.fc27.x86_64 (mockbuild@bkernel02.phx2.fedoraproject.org) (gcc version 7.3.1 20180303 (Red Hat 7.3.1-5) (GCC)) #1 SMP M</pre>
</div>
</div>
<div class="paragraph">
<p>A lot of knowledge came from the folks at Arch Linux:</p>
</div>
<div class="paragraph">
<p><a href="https://wiki.archlinux.org/index.php/intel_graphics#Skylake_support" class="bare">https://wiki.archlinux.org/index.php/intel_graphics#Skylake_support</a></p>
</div>
<div class="paragraph">
<p>Because they stated &#34;to take advantage of some driver options, you will need to create a Xorg configuration file&#34;, I added this to <code>/usr/share/X11/xorg.conf.d/20-intel.conf</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Section &#34;Device&#34;
 Identifier &#34;Intel Graphics&#34;
 Driver &#34;intel&#34;
EndSection</code></pre>
</div>
</div>
<div class="paragraph">
<p>I also enabled &#34;GuC / HuC firmware loading&#34; in <code>/etc/modprobe.d/i915.conf</code>, since I am on kernel 4.16 now.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>options i915 enable_guc=1</pre>
</div>
</div>
<div class="paragraph">
<p>What does all this stuff mean?  I’m not really sure, but I encourage you
to read up on the links if you’re curious.  At any rate, it seems like
something changed in the i915 driver that was being used for my device.
According to a few of these posts, tweaking these driver parameters is
helpful.  Also, reading the <a href="https://jlk.fjfi.cvut.cz/arch/manpages/man/intel.4">intel(4)</a> man page could be helpful.
So far I have not had any crashes, but I will report again if I do.
I’m not even sure if the changes I made will really do anything.  I might
need to update the kernel boot line rather than the modprobe conf.</p>
</div>
<div class="paragraph">
<p>One day I’ll spend more time on video and graphics.  Not today.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debugging">Debugging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Similar Issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://bugs.launchpad.net/ubuntu/+source/xserver-xorg-video-intel/+bug/1552040" class="bare">https://bugs.launchpad.net/ubuntu/+source/xserver-xorg-video-intel/+bug/1552040</a></p>
</li>
</ul>
</div>
</div>
</div>
</section>
    <footer>
      
      
    </footer>
  </article>

    </main>
    <footer>
  <div class="powered-by">
    Powered by <a href="https://gohugo.io" title="A Fast and Flexible Website Generator">Hugo</a> &amp; <a href="https://github.com/eshlox/simplicity" title="Hugo theme">Simplicity</a>.
  </div>
  <div class="copyright">
    &copy; 2023 Everyday Linux. <a href="http://creativecommons.org/licenses/by-sa/4.0/">Some Rights Reserved</a>.
  </div>
</footer>

    <script src="/assets/js/main.28b0c18ba028.js"></script>
    
    
  </body>
</html>
